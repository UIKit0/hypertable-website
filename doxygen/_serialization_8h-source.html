<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>hypertable: /Users/doug/src/hypertable/src/cc/Common/Serialization.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="dir_9e51036813d6151dfecc72d5fa7c02b3.html">Users</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_5708de38a757cb70589c505d18009990.html">doug</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a5f6cd2e2a2b5320bbe75e5c719f1fee.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_752ad1e2f45ee7988941467b4eccee0e.html">hypertable</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_9031e3d7c38caf639b0143600d70b482.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_f5aae9766518c5969fd00e3382787720.html">cc</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_c15830aad3a99e858e4f63b1b1579632.html">Common</a></div>
<h1>Serialization.h</h1><a href="_serialization_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00022"></a>00022 <span class="preprocessor">#ifndef HYPERTABLE_SERIALIZATION_H</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#define HYPERTABLE_SERIALIZATION_H</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#include "<a class="code" href="serialization-c_8h.html">serialization-c.h</a>"</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="namespace_hypertable_1_1_serialization.html">00028</a> <span class="keyword">namespace </span>Hypertable { <span class="keyword">namespace </span>Serialization {
<a name="l00029"></a>00029 
<a name="l00037"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#84279c65251016ad7adcda9b64cbe52d">00037</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#84279c65251016ad7adcda9b64cbe52d" title="Encodes a byte into the given buffer.">encode_i8</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, uint8_t val) {
<a name="l00038"></a>00038     <a class="code" href="serialization-c_8h.html#50e3ba74f29521fecf6cbd75493f846b" title="Encode a 8-bit integer (byte).">HT_ENCODE_I8</a>(*bufp, val);
<a name="l00039"></a>00039   }
<a name="l00040"></a>00040 
<a name="l00048"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#9172e2982cf93570438f27818fac95c1">00048</a>   <span class="keyword">inline</span> uint8_t <a class="code" href="namespace_hypertable_1_1_serialization.html#9172e2982cf93570438f27818fac95c1" title="Decode a 8-bit integer (a byte/character).">decode_i8</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00049"></a>00049     <a class="code" href="serialization-c_8h.html#c59336e3cb91517e34994373384da325">HT_DECODE_NEED</a>(*remainp, 1);
<a name="l00050"></a>00050     <span class="keywordflow">return</span> *(*bufp)++;
<a name="l00051"></a>00051   }
<a name="l00052"></a>00052 
<a name="l00061"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#13c5b005af347bb1da1c9c7fbb33e71a">00061</a>   <span class="keyword">inline</span> uint8_t <a class="code" href="namespace_hypertable_1_1_serialization.html#13c5b005af347bb1da1c9c7fbb33e71a" title="Decodes a single byte from the given buffer.">decode_byte</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00062"></a>00062     <span class="keywordflow">return</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#9172e2982cf93570438f27818fac95c1" title="Decode a 8-bit integer (a byte/character).">decode_i8</a>(bufp, remainp);
<a name="l00063"></a>00063   }
<a name="l00064"></a>00064 
<a name="l00072"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#5cf71fe45c648fab615820bc2bf50a4b">00072</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#5cf71fe45c648fab615820bc2bf50a4b" title="Encodes a boolean into the given buffer.">encode_bool</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">bool</span> bval) {
<a name="l00073"></a>00073     <a class="code" href="serialization-c_8h.html#c9818d0daef14000fb4aa8dd971cc85f" title="Encode a boolean value.">HT_ENCODE_BOOL</a>(*bufp, bval);
<a name="l00074"></a>00074   }
<a name="l00075"></a>00075 
<a name="l00084"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#a8b47fcd45ea75658635dc880c3c8557">00084</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#a8b47fcd45ea75658635dc880c3c8557" title="Decodes a boolean value from the given buffer.">decode_bool</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00085"></a>00085     <span class="keywordflow">return</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#9172e2982cf93570438f27818fac95c1" title="Decode a 8-bit integer (a byte/character).">decode_i8</a>(bufp, remainp) != 0;
<a name="l00086"></a>00086   }
<a name="l00087"></a>00087 
<a name="l00094"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#3463bbf15b8715bd7a6dd7015b5fde18">00094</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#3463bbf15b8715bd7a6dd7015b5fde18" title="Encode a 16-bit integer in little-endian order.">encode_i16</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a> , uint16_t val) {
<a name="l00095"></a>00095     <a class="code" href="serialization-c_8h.html#d51c015ff0fd4f68190cf3b2294404e8" title="Encode a 16 bit integer in little endian format.">HT_ENCODE_I16</a>(*bufp, val);
<a name="l00096"></a>00096   }
<a name="l00097"></a>00097 
<a name="l00105"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#ec36e9cafce4eb2d8fb75d120f311ca1">00105</a>   <span class="keyword">inline</span> uint16_t <a class="code" href="namespace_hypertable_1_1_serialization.html#ec36e9cafce4eb2d8fb75d120f311ca1" title="Decode a 16-bit integer in little-endian order.">decode_i16</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00106"></a>00106     uint16_t val;
<a name="l00107"></a>00107     <a class="code" href="serialization-c_8h.html#2c2894136e86a13fd2ae655a168d08ab" title="Decoded a 16 bit integer encoded in little endian format.">HT_DECODE_I16</a>(*bufp, *remainp, val);
<a name="l00108"></a>00108     <span class="keywordflow">return</span> val;
<a name="l00109"></a>00109   }
<a name="l00110"></a>00110 
<a name="l00117"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#aed56233ded46bd28e8d25fb2bd0a86b">00117</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#aed56233ded46bd28e8d25fb2bd0a86b" title="Encode a 32-bit integer in little-endian order.">encode_i32</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, uint32_t val) {
<a name="l00118"></a>00118     <a class="code" href="serialization-c_8h.html#5c0d5a93c97e26e98a5ffbd2eb354aa0" title="Enocde a 32-bit integer in little endian format.">HT_ENCODE_I32</a>(*bufp, val);
<a name="l00119"></a>00119   }
<a name="l00120"></a>00120 
<a name="l00128"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#19437f0438392abdc4a62fde605d7707">00128</a>   <span class="keyword">inline</span> uint32_t <a class="code" href="namespace_hypertable_1_1_serialization.html#19437f0438392abdc4a62fde605d7707" title="Decode a 32-bit integer in little-endian order.">decode_i32</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00129"></a>00129     uint32_t val;
<a name="l00130"></a>00130     <a class="code" href="serialization-c_8h.html#86bf63199c7cbbe799993b3612b450e3" title="Decode a 32-bit integer encoded in little endian format.">HT_DECODE_I32</a>(*bufp, *remainp, val);
<a name="l00131"></a>00131     <span class="keywordflow">return</span> val;
<a name="l00132"></a>00132   }
<a name="l00133"></a>00133 
<a name="l00140"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#855985be3bf7999195644c10e29a69ae">00140</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#855985be3bf7999195644c10e29a69ae" title="Encode a 64-bit integer in little-endian order.">encode_i64</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, uint64_t val) {
<a name="l00141"></a>00141     <a class="code" href="serialization-c_8h.html#cc4cb83095b727a881b68b84202e43d1" title="Encode a 64-bit integer in little endian format.">HT_ENCODE_I64</a>(*bufp, val);
<a name="l00142"></a>00142   }
<a name="l00143"></a>00143 
<a name="l00151"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#328e404dee6b6951756209d65e562bfe">00151</a>   <span class="keyword">inline</span> uint64_t <a class="code" href="namespace_hypertable_1_1_serialization.html#328e404dee6b6951756209d65e562bfe" title="Decode a 64-bit integer in little-endian order.">decode_i64</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00152"></a>00152     uint64_t val;
<a name="l00153"></a>00153     <a class="code" href="serialization-c_8h.html#361fe594e7f9be85769aa2d5fc108af3" title="Decode a 64-bit integer encoded in little endian format.">HT_DECODE_I64</a>(*bufp, *remainp, val);
<a name="l00154"></a>00154     <span class="keywordflow">return</span> val;
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156 
<a name="l00163"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#07c4640ba62a794c175f05e74ebbd5d3">00163</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#07c4640ba62a794c175f05e74ebbd5d3" title="Length of a variable length encoded 32-bit integer (up to 5 bytes).">encoded_length_vi32</a>(uint32_t val) {
<a name="l00164"></a>00164     <span class="keywordflow">return</span> <a class="code" href="serialization-c_8h.html#a57451ff13f88c5a2c3050a8e249c840" title="vint encoded length of a 32-bit integer">HT_ENCODED_LEN_VI32</a>(val);
<a name="l00165"></a>00165   }
<a name="l00166"></a>00166 
<a name="l00173"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#3e4a63c6d43494ae96cc5f76fa02f197">00173</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#3e4a63c6d43494ae96cc5f76fa02f197" title="Length of a variable length encoded 64-bit integer (up to 9 bytes).">encoded_length_vi64</a>(uint64_t val) {
<a name="l00174"></a>00174     <span class="keywordflow">return</span> <a class="code" href="serialization-c_8h.html#15f743b1d92025d2de1b4d2aa6187092" title="vint encoded length of a 64-bit integer">HT_ENCODED_LEN_VI64</a>(val);
<a name="l00175"></a>00175   }
<a name="l00176"></a>00176 
<a name="l00183"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#76485e00d47270563670c2c108eaeac2">00183</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#76485e00d47270563670c2c108eaeac2" title="Encode a integer (up to 32-bit) in variable length encoding.">encode_vi32</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, uint32_t val) {
<a name="l00184"></a>00184     <a class="code" href="serialization-c_8h.html#61d495a804bb4764ab84c7b9f0f1c368" title="Encode a 32-bit integer in vint format.">HT_ENCODE_VI32</a>(*bufp, val, <span class="keywordflow">return</span>);
<a name="l00185"></a>00185   }
<a name="l00186"></a>00186 
<a name="l00193"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#49d31f7df721d23118f9f955047aff66">00193</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#49d31f7df721d23118f9f955047aff66" title="Encode a integer (up to 64-bit) in variable length encoding.">encode_vi64</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, uint64_t val) {
<a name="l00194"></a>00194     <a class="code" href="serialization-c_8h.html#ea4f73391142833ff0c147053dd66cae" title="Encode a 64-bit integer in vint format.">HT_ENCODE_VI64</a>(*bufp, val, <span class="keywordflow">return</span>);
<a name="l00195"></a>00195   }
<a name="l00196"></a>00196 
<a name="l00204"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#a7535faf5efd7eec7a5f8111921e5f95">00204</a>   <span class="keyword">inline</span> uint32_t <a class="code" href="namespace_hypertable_1_1_serialization.html#a7535faf5efd7eec7a5f8111921e5f95" title="Decode a variable length encoded integer up to 32-bit.">decode_vi32</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00205"></a>00205     uint32_t n;
<a name="l00206"></a>00206     <a class="code" href="serialization-c_8h.html#08db49dc43d8299123d79ab3e2167b0b" title="Decode a 32-bit integer encoded in vint format.">HT_DECODE_VI32</a>(*bufp, *remainp, n, <span class="keywordflow">return</span> n);
<a name="l00207"></a>00207   }
<a name="l00208"></a>00208 
<a name="l00216"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#fed7d407d02f79eb17ab31d19f06a330">00216</a>   <span class="keyword">inline</span> uint64_t <a class="code" href="namespace_hypertable_1_1_serialization.html#fed7d407d02f79eb17ab31d19f06a330" title="Decode a variable length encoded integer up to 64-bit.">decode_vi64</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00217"></a>00217     uint64_t n;
<a name="l00218"></a>00218     <a class="code" href="serialization-c_8h.html#403a21982b51969576770aa6ce776e69" title="Decode a 64-bit integer encoded in vint format.">HT_DECODE_VI64</a>(*bufp, *remainp, n, <span class="keywordflow">return</span> n);
<a name="l00219"></a>00219   }
<a name="l00220"></a>00220 
<a name="l00227"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#b86f8446db63272ddb0994d1badd2d78">00227</a>   <span class="keyword">inline</span> uint32_t <a class="code" href="namespace_hypertable_1_1_serialization.html#a7535faf5efd7eec7a5f8111921e5f95" title="Decode a variable length encoded integer up to 32-bit.">decode_vi32</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>) {
<a name="l00228"></a>00228     <span class="keywordtype">size_t</span> remain = 6;
<a name="l00229"></a>00229     <span class="keywordflow">return</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#a7535faf5efd7eec7a5f8111921e5f95" title="Decode a variable length encoded integer up to 32-bit.">decode_vi32</a>(bufp, &amp;remain);
<a name="l00230"></a>00230   }
<a name="l00231"></a>00231 
<a name="l00238"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#80faa25d46370b97984c4eab45831d59">00238</a>   <span class="keyword">inline</span> uint64_t <a class="code" href="namespace_hypertable_1_1_serialization.html#fed7d407d02f79eb17ab31d19f06a330" title="Decode a variable length encoded integer up to 64-bit.">decode_vi64</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>) {
<a name="l00239"></a>00239     <span class="keywordtype">size_t</span> remain = 12;
<a name="l00240"></a>00240     <span class="keywordflow">return</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#fed7d407d02f79eb17ab31d19f06a330" title="Decode a variable length encoded integer up to 64-bit.">decode_vi64</a>(bufp, &amp;remain);
<a name="l00241"></a>00241   }
<a name="l00242"></a>00242 
<a name="l00249"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#4934596786a79b90d5847d08edcf08e9">00249</a>   <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#4934596786a79b90d5847d08edcf08e9" title="Computes the encoded length of a 32-bit length byte array (i32, bytes).">encoded_length_bytes32</a>(int32_t <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a>) {
<a name="l00250"></a>00250     <span class="keywordflow">return</span> len + 4;
<a name="l00251"></a>00251   }
<a name="l00252"></a>00252 
<a name="l00262"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#697da2b8b8e712f080b3b39355afbc75">00262</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#697da2b8b8e712f080b3b39355afbc75" title="Encodes a variable sized byte array into the given buffer.">encode_bytes32</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *data, int32_t <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a>) {
<a name="l00263"></a>00263     <a class="code" href="serialization-c_8h.html#45362c30d297ad019c812b4884572a1d" title="Encode a buffer in bytes32 format (i32, data).">HT_ENCODE_BYTES32</a>(*bufp, data, len);
<a name="l00264"></a>00264   }
<a name="l00265"></a>00265 
<a name="l00275"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#ac64285d2eb0e7713b4cdbae3f2af7ae">00275</a>   <span class="keyword">inline</span> uint8_t *<a class="code" href="namespace_hypertable_1_1_serialization.html#ac64285d2eb0e7713b4cdbae3f2af7ae" title="Decodes a variable sized byte array from the given buffer.">decode_bytes32</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp,
<a name="l00276"></a>00276                                  uint32_t *lenp) {
<a name="l00277"></a>00277     uint8_t *out;
<a name="l00278"></a>00278     <a class="code" href="serialization-c_8h.html#8ac96691c032353bce013204c1a0b654" title="Decode bytes32 (i32, data).">HT_DECODE_BYTES32</a>(*bufp, *remainp, out, *lenp);
<a name="l00279"></a>00279     <span class="keywordflow">return</span> out;
<a name="l00280"></a>00280   }
<a name="l00281"></a>00281 
<a name="l00288"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#8967c9991f7ee857c84c3c8e50db3df9">00288</a>   <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#8967c9991f7ee857c84c3c8e50db3df9" title="Computes the encoded length of a string16 encoding.">encoded_length_str16</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespace_hypertable_1_1_property.html#85c9eccd71abb77e3c7b42ea81dc9ac4">str</a>) {
<a name="l00289"></a>00289     <span class="keywordflow">return</span> 2 + ((str == 0) ? 0 : strlen(str)) + 1;
<a name="l00290"></a>00290   }
<a name="l00291"></a>00291 
<a name="l00298"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#597b1e44ee4e973d1c87719dc4cb04ed">00298</a>   <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#8967c9991f7ee857c84c3c8e50db3df9" title="Computes the encoded length of a string16 encoding.">encoded_length_str16</a>(<span class="keyword">const</span> <a class="code" href="namespace_hypertable.html#bd74d0aa26c0528285dc77325ca89511" title="We might want to use something better later, as std::string always causes a heap...">String</a> &amp;<a class="code" href="namespace_hypertable_1_1_property.html#85c9eccd71abb77e3c7b42ea81dc9ac4">str</a>) {
<a name="l00299"></a>00299     <span class="keywordflow">return</span> 2 + str.length() + 1;
<a name="l00300"></a>00300   }
<a name="l00301"></a>00301 
<a name="l00313"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#0a4afb490822f9b6b0d5fe6576896ca4">00313</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#0a4afb490822f9b6b0d5fe6576896ca4" title="Encodes a string buffer into the given buffer.">encode_str16</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespace_hypertable_1_1_property.html#85c9eccd71abb77e3c7b42ea81dc9ac4">str</a>, uint16_t <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a>) {
<a name="l00314"></a>00314     <a class="code" href="serialization-c_8h.html#59fb6759059ce3b6c652bce3b407b0bb" title="Encode a string buffer in str16 format (i16, data, null).">HT_ENCODE_STR16</a>(*bufp, str, len);
<a name="l00315"></a>00315   }
<a name="l00316"></a>00316 
<a name="l00327"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#10fba8f4cba9b1523e67deac72270b55">00327</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#0a4afb490822f9b6b0d5fe6576896ca4" title="Encodes a string buffer into the given buffer.">encode_str16</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespace_hypertable_1_1_property.html#85c9eccd71abb77e3c7b42ea81dc9ac4">str</a>) {
<a name="l00328"></a>00328     uint16_t <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a> = (str == 0) ? 0 : strlen(str);
<a name="l00329"></a>00329     <a class="code" href="namespace_hypertable_1_1_serialization.html#0a4afb490822f9b6b0d5fe6576896ca4" title="Encodes a string buffer into the given buffer.">encode_str16</a>(bufp, str, len);
<a name="l00330"></a>00330   }
<a name="l00331"></a>00331 
<a name="l00342"></a>00342   <span class="keyword">template</span> &lt;<span class="keyword">class</span> StringT&gt;
<a name="l00343"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#714b4f163bc2f67d1649a1074e00210b">00343</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#0a4afb490822f9b6b0d5fe6576896ca4" title="Encodes a string buffer into the given buffer.">encode_str16</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keyword">const</span> StringT &amp;<a class="code" href="namespace_hypertable_1_1_property.html#85c9eccd71abb77e3c7b42ea81dc9ac4">str</a>) {
<a name="l00344"></a>00344     <a class="code" href="namespace_hypertable_1_1_serialization.html#0a4afb490822f9b6b0d5fe6576896ca4" title="Encodes a string buffer into the given buffer.">encode_str16</a>(bufp, str.c_str(), str.length());
<a name="l00345"></a>00345   }
<a name="l00346"></a>00346 
<a name="l00358"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#f1023f260dede42e5744864c35b6c38f">00358</a>   <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespace_hypertable_1_1_serialization.html#f1023f260dede42e5744864c35b6c38f" title="Decodes a c-style string from the given buffer.">decode_str16</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00359"></a>00359     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespace_hypertable_1_1_property.html#85c9eccd71abb77e3c7b42ea81dc9ac4">str</a>;
<a name="l00360"></a>00360     uint16_t <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a>;
<a name="l00361"></a>00361     <a class="code" href="serialization-c_8h.html#1303e53cf5ef898ea85c9c0fb5246a57" title="Decode str16 (i16, data, null).">HT_DECODE_STR16</a>(*bufp, *remainp, str, len);
<a name="l00362"></a>00362     <span class="keywordflow">return</span> str;
<a name="l00363"></a>00363   }
<a name="l00364"></a>00364 
<a name="l00377"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#f34adb869c349af75a12b633b883bca0">00377</a>   <span class="keyword">inline</span> <span class="keywordtype">char</span> *<a class="code" href="namespace_hypertable_1_1_serialization.html#f1023f260dede42e5744864c35b6c38f" title="Decodes a c-style string from the given buffer.">decode_str16</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp,
<a name="l00378"></a>00378                                   uint16_t *lenp) {
<a name="l00379"></a>00379     <span class="keywordtype">char</span> *<a class="code" href="namespace_hypertable_1_1_property.html#85c9eccd71abb77e3c7b42ea81dc9ac4">str</a>;
<a name="l00380"></a>00380     <a class="code" href="serialization-c_8h.html#1303e53cf5ef898ea85c9c0fb5246a57" title="Decode str16 (i16, data, null).">HT_DECODE_STR16</a>(*bufp, *remainp, str, *lenp);
<a name="l00381"></a>00381     <span class="keywordflow">return</span> str;
<a name="l00382"></a>00382   }
<a name="l00383"></a>00383 
<a name="l00394"></a>00394   <span class="keyword">template</span> &lt;<span class="keyword">class</span> StringT&gt;
<a name="l00395"></a>00395   <span class="keyword">inline</span> StringT <a class="code" href="namespace_hypertable_1_1_serialization.html#f1023f260dede42e5744864c35b6c38f" title="Decodes a c-style string from the given buffer.">decode_str16</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00396"></a>00396     <span class="keywordtype">char</span> *<a class="code" href="namespace_hypertable_1_1_property.html#85c9eccd71abb77e3c7b42ea81dc9ac4">str</a>;
<a name="l00397"></a>00397     uint16_t <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a>;
<a name="l00398"></a>00398     <a class="code" href="serialization-c_8h.html#1303e53cf5ef898ea85c9c0fb5246a57" title="Decode str16 (i16, data, null).">HT_DECODE_STR16</a>(*bufp, *remainp, str, len);
<a name="l00399"></a>00399     <span class="keywordflow">return</span> StringT(str, len); <span class="comment">// RVO hopeful</span>
<a name="l00400"></a>00400   }
<a name="l00401"></a>00401 
<a name="l00408"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#39997cefbef5abff6a0e8e6b8efcc1ec">00408</a>   <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#39997cefbef5abff6a0e8e6b8efcc1ec" title="Computes the encoded length of vstr (vint64, data, null).">encoded_length_vstr</a>(<span class="keywordtype">size_t</span> <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a>) {
<a name="l00409"></a>00409     <span class="keywordflow">return</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#3e4a63c6d43494ae96cc5f76fa02f197" title="Length of a variable length encoded 64-bit integer (up to 9 bytes).">encoded_length_vi64</a>(len) + len + 1;
<a name="l00410"></a>00410   }
<a name="l00411"></a>00411 
<a name="l00419"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#0a1da082decd9869d834d383f2179974">00419</a>   <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#39997cefbef5abff6a0e8e6b8efcc1ec" title="Computes the encoded length of vstr (vint64, data, null).">encoded_length_vstr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s) {
<a name="l00420"></a>00420     <span class="keywordflow">return</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#39997cefbef5abff6a0e8e6b8efcc1ec" title="Computes the encoded length of vstr (vint64, data, null).">encoded_length_vstr</a>(s ? strlen(s) : 0);
<a name="l00421"></a>00421   }
<a name="l00422"></a>00422 
<a name="l00430"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#4ca82afa281360df02b9711740567e27">00430</a>   <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#39997cefbef5abff6a0e8e6b8efcc1ec" title="Computes the encoded length of vstr (vint64, data, null).">encoded_length_vstr</a>(<span class="keyword">const</span> <a class="code" href="namespace_hypertable.html#bd74d0aa26c0528285dc77325ca89511" title="We might want to use something better later, as std::string always causes a heap...">String</a> &amp;s) {
<a name="l00431"></a>00431     <span class="keywordflow">return</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#39997cefbef5abff6a0e8e6b8efcc1ec" title="Computes the encoded length of vstr (vint64, data, null).">encoded_length_vstr</a>(s.length());
<a name="l00432"></a>00432   }
<a name="l00433"></a>00433 
<a name="l00441"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#46ee21e21f9ecf2ba6d52e163b8e2f18">00441</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#46ee21e21f9ecf2ba6d52e163b8e2f18" title="Encode a buffer as vstr (vint64, data, null).">encode_vstr</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *buf, <span class="keywordtype">size_t</span> <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a>) {
<a name="l00442"></a>00442     <a class="code" href="serialization-c_8h.html#f9c87f3eb772783ffdae4be9b9b8e521" title="Encode in vstr format (vint, data, null).">HT_ENCODE_VSTR</a>(*bufp, buf, len);
<a name="l00443"></a>00443   }
<a name="l00444"></a>00444 
<a name="l00451"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#d0045be4ae68c074f7c25e79d0060727">00451</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#46ee21e21f9ecf2ba6d52e163b8e2f18" title="Encode a buffer as vstr (vint64, data, null).">encode_vstr</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *s) {
<a name="l00452"></a>00452     <a class="code" href="namespace_hypertable_1_1_serialization.html#46ee21e21f9ecf2ba6d52e163b8e2f18" title="Encode a buffer as vstr (vint64, data, null).">encode_vstr</a>(bufp, s, s ? strlen(s) : 0);
<a name="l00453"></a>00453   }
<a name="l00454"></a>00454 
<a name="l00461"></a>00461   <span class="keyword">template</span> &lt;<span class="keyword">class</span> StringT&gt;
<a name="l00462"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#40ce52e8ba556769374a00f7149b167e">00462</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespace_hypertable_1_1_serialization.html#46ee21e21f9ecf2ba6d52e163b8e2f18" title="Encode a buffer as vstr (vint64, data, null).">encode_vstr</a>(uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keyword">const</span> StringT &amp;s) {
<a name="l00463"></a>00463     <a class="code" href="namespace_hypertable_1_1_serialization.html#46ee21e21f9ecf2ba6d52e163b8e2f18" title="Encode a buffer as vstr (vint64, data, null).">encode_vstr</a>(bufp, s.data(), s.length());
<a name="l00464"></a>00464   }
<a name="l00465"></a>00465 
<a name="l00475"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#ea801c536672942c9a747f9525d6c597">00475</a>   <span class="keyword">inline</span> <span class="keywordtype">char</span> *<a class="code" href="namespace_hypertable_1_1_serialization.html#ea801c536672942c9a747f9525d6c597" title="Decode a vstr (vint64, data, null) Note, decoding a vstr longer than 4GiB on a 32-bit...">decode_vstr</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00476"></a>00476     <span class="keywordtype">char</span> *buf;
<a name="l00477"></a>00477     <span class="keywordtype">size_t</span> <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a>;
<a name="l00478"></a>00478     <a class="code" href="serialization-c_8h.html#450134409d0895300ab1c0800b2a7f4b" title="Decode a vstr (vint, data, null).">HT_DECODE_VSTR</a>(*bufp, *remainp, buf, len);
<a name="l00479"></a>00479     <span class="keywordflow">return</span> buf;
<a name="l00480"></a>00480   }
<a name="l00481"></a>00481 
<a name="l00489"></a>00489   <span class="keyword">template</span> &lt;<span class="keyword">class</span> StringT&gt;
<a name="l00490"></a>00490   <span class="keyword">inline</span> <a class="code" href="namespace_hypertable.html#bd74d0aa26c0528285dc77325ca89511" title="We might want to use something better later, as std::string always causes a heap...">String</a> <a class="code" href="namespace_hypertable_1_1_serialization.html#ea801c536672942c9a747f9525d6c597" title="Decode a vstr (vint64, data, null) Note, decoding a vstr longer than 4GiB on a 32-bit...">decode_vstr</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp) {
<a name="l00491"></a>00491     <span class="keywordtype">char</span> *buf;
<a name="l00492"></a>00492     <span class="keywordtype">size_t</span> <a class="code" href="_range_server_8cc.html#ccdb2dff228b7a3ea4c3f61937a82412">len</a>;
<a name="l00493"></a>00493     <a class="code" href="serialization-c_8h.html#450134409d0895300ab1c0800b2a7f4b" title="Decode a vstr (vint, data, null).">HT_DECODE_VSTR</a>(*bufp, *remainp, buf, len);
<a name="l00494"></a>00494     <span class="keywordflow">return</span> StringT(buf, len); <span class="comment">// RVO</span>
<a name="l00495"></a>00495   }
<a name="l00496"></a>00496 
<a name="l00505"></a><a class="code" href="namespace_hypertable_1_1_serialization.html#fd9186925807e60268fa7a2ae2c128a8">00505</a>   <span class="keyword">inline</span> <span class="keywordtype">char</span> *<a class="code" href="namespace_hypertable_1_1_serialization.html#ea801c536672942c9a747f9525d6c597" title="Decode a vstr (vint64, data, null) Note, decoding a vstr longer than 4GiB on a 32-bit...">decode_vstr</a>(<span class="keyword">const</span> uint8_t **<a class="code" href="_range_server_8cc.html#dfb94b37a8e871e558c01a70cc878353">bufp</a>, <span class="keywordtype">size_t</span> *remainp,
<a name="l00506"></a>00506                            uint32_t *lenp) {
<a name="l00507"></a>00507     <span class="keywordtype">char</span> *buf;
<a name="l00508"></a>00508     <a class="code" href="serialization-c_8h.html#450134409d0895300ab1c0800b2a7f4b" title="Decode a vstr (vint, data, null).">HT_DECODE_VSTR</a>(*bufp, *remainp, buf, *lenp);
<a name="l00509"></a>00509     <span class="keywordflow">return</span> buf;
<a name="l00510"></a>00510   }
<a name="l00511"></a>00511 
<a name="l00512"></a>00512 
<a name="l00513"></a>00513 }} <span class="comment">// namespace Hypertable::Serialization</span>
<a name="l00514"></a>00514 
<a name="l00515"></a>00515 <span class="preprocessor">#endif // HYPERTABLE_SERIALIZATION_H</span>
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Mon Dec 8 12:29:48 2008 for hypertable by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
