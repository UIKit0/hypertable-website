<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>hypertable: /Users/doug/src/hypertable/src/cc/Hyperspace/Master.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="dir_9e51036813d6151dfecc72d5fa7c02b3.html">Users</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_5708de38a757cb70589c505d18009990.html">doug</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a5f6cd2e2a2b5320bbe75e5c719f1fee.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_752ad1e2f45ee7988941467b4eccee0e.html">hypertable</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_9031e3d7c38caf639b0143600d70b482.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_f5aae9766518c5969fd00e3382787720.html">cc</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_baadc7c4b53cf4594df7618997f6c732.html">Hyperspace</a></div>
<h1>Master.h</h1><a href="_hyperspace_2_master_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00022"></a>00022 <span class="preprocessor">#ifndef HYPERSPACE_MASTER_H</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#define HYPERSPACE_MASTER_H</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;queue&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;boost/thread/mutex.hpp&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include "<a class="code" href="atomic_8h.html">Common/atomic.h</a>"</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include "<a class="code" href="_properties_8h.html">Common/Properties.h</a>"</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="_reference_count_8h.html">Common/ReferenceCount.h</a>"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="_sock_addr_map_8h.html">Common/SockAddrMap.h</a>"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include "<a class="code" href="_string_ext_8h.html">Common/StringExt.h</a>"</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include "<a class="code" href="_comm_8h.html">AsyncComm/Comm.h</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include "<a class="code" href="_connection_manager_8h.html">AsyncComm/ConnectionManager.h</a>"</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include "<a class="code" href="_async_comm_2_event_8h.html">AsyncComm/Event.h</a>"</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include "<a class="code" href="_response_callback_8h.html">AsyncComm/ResponseCallback.h</a>"</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#include "<a class="code" href="_berkeley_db_filesystem_8h.html">BerkeleyDbFilesystem.h</a>"</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include "<a class="code" href="_node_data_8h.html">NodeData.h</a>"</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include "<a class="code" href="_handle_data_8h.html">HandleData.h</a>"</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include "<a class="code" href="_hyperspace_2_protocol_8h.html">Protocol.h</a>"</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include "<a class="code" href="_hyperspace_2_response_callback_open_8h.html">ResponseCallbackOpen.h</a>"</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include "<a class="code" href="_hyperspace_2_response_callback_exists_8h.html">ResponseCallbackExists.h</a>"</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include "<a class="code" href="_response_callback_attr_get_8h.html">ResponseCallbackAttrGet.h</a>"</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include "<a class="code" href="_response_callback_lock_8h.html">ResponseCallbackLock.h</a>"</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include "<a class="code" href="_hyperspace_2_response_callback_readdir_8h.html">ResponseCallbackReaddir.h</a>"</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include "<a class="code" href="_server_keepalive_handler_8h.html">ServerKeepaliveHandler.h</a>"</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include "<a class="code" href="_session_data_8h.html">SessionData.h</a>"</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="keyword">namespace </span>Hyperspace {
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="class_hyperspace_1_1_master.html">00056</a>   <span class="keyword">class </span><a class="code" href="class_hyperspace_1_1_master.html">Master</a> : <span class="keyword">public</span> <a class="code" href="class_hypertable_1_1_reference_count.html" title="This class is meant to be a base class for all classes that want to be referenced...">ReferenceCount</a> {
<a name="l00057"></a>00057   <span class="keyword">public</span>:
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="class_hyperspace_1_1_master.html#359887d9840acd73850aafa567ef0034">00059</a>     <span class="keyword">static</span> <span class="keyword">const</span> uint32_t <a class="code" href="class_hyperspace_1_1_master.html#359887d9840acd73850aafa567ef0034">DEFAULT_MASTER_PORT</a>        = 38040;
<a name="l00060"></a><a class="code" href="class_hyperspace_1_1_master.html#85ba0ea52e3bcd34e7ea1696d5e37d7b">00060</a>     <span class="keyword">static</span> <span class="keyword">const</span> uint32_t <a class="code" href="class_hyperspace_1_1_master.html#85ba0ea52e3bcd34e7ea1696d5e37d7b">DEFAULT_LEASE_INTERVAL</a>     = 20;
<a name="l00061"></a><a class="code" href="class_hyperspace_1_1_master.html#5e0f7d47fdda5ded7aa6a9ba6d4598a1">00061</a>     <span class="keyword">static</span> <span class="keyword">const</span> uint32_t <a class="code" href="class_hyperspace_1_1_master.html#5e0f7d47fdda5ded7aa6a9ba6d4598a1">DEFAULT_KEEPALIVE_INTERVAL</a> = 10;
<a name="l00062"></a><a class="code" href="class_hyperspace_1_1_master.html#cf90a54ef7fed716c9300bf109d8c400">00062</a>     <span class="keyword">static</span> <span class="keyword">const</span> uint32_t <a class="code" href="class_hyperspace_1_1_master.html#cf90a54ef7fed716c9300bf109d8c400">DEFAULT_GRACEPERIOD</a>        = 60;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     <a class="code" href="class_hyperspace_1_1_master.html#5efa12b4f86734c451f106aa599e600f" title="Sets up the m_base_dir variable to be the absolute path of the root of the Hyperspace...">Master</a>(<a class="code" href="namespace_hypertable.html#e048a08bc9bd9505788d6e5823c948ae">ConnectionManagerPtr</a> &amp;, <a class="code" href="namespace_hypertable.html#8c3eeb0c64dcf09ba41222b111894c12">PropertiesPtr</a> &amp;,
<a name="l00065"></a>00065            <a class="code" href="namespace_hyperspace.html#3e886fe6754f12ba9f134097157d2673">ServerKeepaliveHandlerPtr</a> &amp;);
<a name="l00066"></a>00066     <a class="code" href="class_hyperspace_1_1_master.html#20f70958ed75532ba672af1b780f59eb">~Master</a>();
<a name="l00067"></a>00067 
<a name="l00068"></a>00068     <span class="comment">// Hyperspace command implementations</span>
<a name="l00069"></a>00069     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#ffb4120218185ca6935f38987f0df956" title="Creates a directory with absolute path &amp;#39;name&amp;#39;.">mkdir</a>(<a class="code" href="class_hypertable_1_1_response_callback.html" title="This class is used to deliver responses, corresponding to a request, back to a client...">ResponseCallback</a> *cb, uint64_t session_id, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00070"></a>00070     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#f421f36137d330ee9adac823c244eb3c" title="Delete.">unlink</a>(<a class="code" href="class_hypertable_1_1_response_callback.html" title="This class is used to deliver responses, corresponding to a request, back to a client...">ResponseCallback</a> *cb, uint64_t session_id, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00071"></a>00071     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#6344199cfd07ae410908d8344d6a3d8c" title="Open.">open</a>(<a class="code" href="class_hyperspace_1_1_response_callback_open.html">ResponseCallbackOpen</a> *cb, uint64_t session_id, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00072"></a>00072               uint32_t flags, uint32_t event_mask,
<a name="l00073"></a>00073               std::vector&lt;Attribute&gt; &amp;init_attrs);
<a name="l00074"></a>00074     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#8ba65afd1547cac97ab5ad2510e02e34">close</a>(<a class="code" href="class_hypertable_1_1_response_callback.html" title="This class is used to deliver responses, corresponding to a request, back to a client...">ResponseCallback</a> *cb, uint64_t session_id, uint64_t handle);
<a name="l00075"></a>00075     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#00ee27aea56fa8c17cfe6ad1f1e6c71d">attr_set</a>(<a class="code" href="class_hypertable_1_1_response_callback.html" title="This class is used to deliver responses, corresponding to a request, back to a client...">ResponseCallback</a> *cb, uint64_t session_id, uint64_t handle,
<a name="l00076"></a>00076                   <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">void</span> *value, <span class="keywordtype">size_t</span> value_len);
<a name="l00077"></a>00077     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#25f1e3e31b52e2d3cf4174559d99030b">attr_get</a>(<a class="code" href="class_hyperspace_1_1_response_callback_attr_get.html">ResponseCallbackAttrGet</a> *cb, uint64_t session_id,
<a name="l00078"></a>00078                   uint64_t handle, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00079"></a>00079     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#5b43b624a1672c7774a3e39bc6ca9dfa">attr_del</a>(<a class="code" href="class_hypertable_1_1_response_callback.html" title="This class is used to deliver responses, corresponding to a request, back to a client...">ResponseCallback</a> *cb, uint64_t session_id, uint64_t handle,
<a name="l00080"></a>00080                   <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00081"></a>00081     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#646865e97a872790f9090e39309460d3">exists</a>(<a class="code" href="class_hyperspace_1_1_response_callback_exists.html">ResponseCallbackExists</a> *cb, uint64_t session_id,
<a name="l00082"></a>00082                 <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00083"></a>00083     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#ac608b275e306f66b019c6f5ac9ac937">readdir</a>(<a class="code" href="class_hyperspace_1_1_response_callback_readdir.html">ResponseCallbackReaddir</a> *cb, uint64_t session_id,
<a name="l00084"></a>00084                  uint64_t handle);
<a name="l00085"></a>00085     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#e9ff9f9b68e57c5a9c1f8ab1b06bc9a1">lock</a>(<a class="code" href="class_hyperspace_1_1_response_callback_lock.html">ResponseCallbackLock</a> *cb, uint64_t session_id, uint64_t handle,
<a name="l00086"></a>00086               uint32_t mode, <span class="keywordtype">bool</span> try_lock);
<a name="l00087"></a>00087     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#e4e1b58c6606e16819cc514d4e036967">release</a>(<a class="code" href="class_hypertable_1_1_response_callback.html" title="This class is used to deliver responses, corresponding to a request, back to a client...">ResponseCallback</a> *cb, uint64_t session_id, uint64_t handle);
<a name="l00088"></a>00088 
<a name="l00096"></a>00096     uint64_t <a class="code" href="class_hyperspace_1_1_master.html#56daab02dae50f0b0facb14ba268911f" title="Creates a new session by allocating a new SessionData object, obtaining a new session...">create_session</a>(<span class="keyword">struct</span> sockaddr_in &amp;addr);
<a name="l00097"></a>00097 
<a name="l00105"></a>00105     <span class="keywordtype">bool</span> <a class="code" href="class_hyperspace_1_1_master.html#17b107ae3e2489ebef7f692006153e5a" title="Obtains the SessionData object for the given id from the session map.">get_session</a>(uint64_t session_id, <a class="code" href="namespace_hyperspace.html#bf8a2306f11c783cfc4c53778e399a95">SessionDataPtr</a> &amp;session_data);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#debd5fdfe694e94c6864b62930dc70bc">destroy_session</a>(uint64_t session_id);
<a name="l00108"></a>00108 
<a name="l00118"></a>00118     <span class="keywordtype">int</span> <a class="code" href="class_hyperspace_1_1_master.html#a9f9e3d5a12375c4e4d7978513c6b309" title="Attempts to renew the session lease for session with the given ID.">renew_session_lease</a>(uint64_t session_id);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <span class="keywordtype">bool</span> <a class="code" href="class_hyperspace_1_1_master.html#68fd1107475d50d0edb992f3a14db417">next_expired_session</a>(<a class="code" href="namespace_hyperspace.html#bf8a2306f11c783cfc4c53778e399a95">SessionDataPtr</a> &amp;session_data);
<a name="l00121"></a>00121     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#ff4b480032f1e1efeb10bb8276c00e57">remove_expired_sessions</a>();
<a name="l00122"></a>00122 
<a name="l00123"></a>00123     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#db33762164787046f118055e4b251e71">create_handle</a>(uint64_t *handlep, <a class="code" href="namespace_hyperspace.html#10c2f43e6bf999559f90bad8c67500fc">HandleDataPtr</a> &amp;handle_data);
<a name="l00124"></a>00124     <span class="keywordtype">bool</span> <a class="code" href="class_hyperspace_1_1_master.html#98aa2672c33477a4d8c6321e23685967">get_handle_data</a>(uint64_t session_id, <a class="code" href="namespace_hyperspace.html#10c2f43e6bf999559f90bad8c67500fc">HandleDataPtr</a> &amp;handle_data);
<a name="l00125"></a>00125     <span class="keywordtype">bool</span> <a class="code" href="class_hyperspace_1_1_master.html#5d802afc2f4fd3f46f26c7e7ea15ed74">remove_handle_data</a>(uint64_t session_id, <a class="code" href="namespace_hyperspace.html#10c2f43e6bf999559f90bad8c67500fc">HandleDataPtr</a> &amp;handle_data);
<a name="l00126"></a>00126 
<a name="l00127"></a><a class="code" href="class_hyperspace_1_1_master.html#c0e86bac801a18e7150a689264fcd2d7">00127</a>     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#c0e86bac801a18e7150a689264fcd2d7">get_datagram_send_address</a>(<span class="keyword">struct</span> sockaddr_in *addr) {
<a name="l00128"></a>00128       memcpy(addr, &amp;<a class="code" href="class_hyperspace_1_1_master.html#5d57a150539189795c452165d8dd3615">m_local_addr</a>, <span class="keyword">sizeof</span>(<a class="code" href="class_hyperspace_1_1_master.html#5d57a150539189795c452165d8dd3615">m_local_addr</a>));
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131   <span class="keyword">private</span>:
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#a5ead2c369448b90638d650e53037ef9">get_generation_number</a>();
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#d3fe16cdacfbaf3afd56d68b4a64934e">normalize_name</a>(std::string name, std::string &amp;normal);
<a name="l00136"></a>00136     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#b8942dfb7988bc920c74bf8d4deb2217" title="Assumes node is locked.">deliver_event_notifications</a>(<a class="code" href="class_hyperspace_1_1_node_data.html">NodeData</a> *node, <a class="code" href="namespace_hyperspace.html#5a0d997757fe62feaa83461afd2abe54">HyperspaceEventPtr</a> &amp;,
<a name="l00137"></a>00137                                      <span class="keywordtype">bool</span> wait_for_notify=<span class="keyword">true</span>);
<a name="l00138"></a>00138     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#a37ce1748f420bab8c21e1b35603265f" title="Assumes node is locked.">deliver_event_notification</a>(<a class="code" href="namespace_hyperspace.html#10c2f43e6bf999559f90bad8c67500fc">HandleDataPtr</a> &amp;handle_data,
<a name="l00139"></a>00139                                     <a class="code" href="namespace_hyperspace.html#5a0d997757fe62feaa83461afd2abe54">HyperspaceEventPtr</a> &amp;event_ptr,
<a name="l00140"></a>00140                                     <span class="keywordtype">bool</span> wait_for_notify=<span class="keyword">true</span>);
<a name="l00141"></a>00141 
<a name="l00158"></a>00158     <span class="keywordtype">bool</span> <a class="code" href="class_hyperspace_1_1_master.html#22c21b63b74d6a8485ea273d18631500" title="Locates the parent &amp;#39;node&amp;#39; of the given pathname.">find_parent_node</a>(<span class="keyword">const</span> std::string &amp;normal_name,
<a name="l00159"></a>00159                           <a class="code" href="namespace_hyperspace.html#ea6276fa0665b02c8f6f505c2255a2f1">NodeDataPtr</a> &amp;parent_node, std::string &amp;child_name);
<a name="l00160"></a>00160     <span class="keywordtype">bool</span> <a class="code" href="class_hyperspace_1_1_master.html#1d410ddf0a2b4b5f167cda1a79ecf5ed">destroy_handle</a>(uint64_t handle, <span class="keywordtype">int</span> *errorp, std::string &amp;errmsg,
<a name="l00161"></a>00161                         <span class="keywordtype">bool</span> wait_for_notify=<span class="keyword">true</span>);
<a name="l00162"></a>00162     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#4787da2e7f83ef32e9b7ff37cac45a9f">release_lock</a>(<a class="code" href="namespace_hyperspace.html#10c2f43e6bf999559f90bad8c67500fc">HandleDataPtr</a> &amp;handle_data, <span class="keywordtype">bool</span> wait_for_notify=<span class="keyword">true</span>);
<a name="l00163"></a>00163     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#fb8229dc56d4c14f1e0597e6118b40b7" title="Assumes node is locked.">lock_handle</a>(<a class="code" href="namespace_hyperspace.html#10c2f43e6bf999559f90bad8c67500fc">HandleDataPtr</a> &amp;handle_data, uint32_t mode);
<a name="l00164"></a>00164     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#201bd977c2e1175876e5076852582ed5" title="Assumes node is locked.">lock_handle_with_notification</a>(<a class="code" href="namespace_hyperspace.html#10c2f43e6bf999559f90bad8c67500fc">HandleDataPtr</a> &amp;handle_data,
<a name="l00165"></a>00165                                        uint32_t mode,
<a name="l00166"></a>00166                                        <span class="keywordtype">bool</span> wait_for_notify=<span class="keyword">true</span>);
<a name="l00167"></a>00167 
<a name="l00175"></a><a class="code" href="class_hyperspace_1_1_master.html#260cebfd9def600a5fafb4ebefad61c8">00175</a>     <span class="keywordtype">void</span> <a class="code" href="class_hyperspace_1_1_master.html#260cebfd9def600a5fafb4ebefad61c8" title="Safely obtains the node with the given pathname from the NodeMap, creating one and...">get_node</a>(std::string name, <a class="code" href="namespace_hyperspace.html#ea6276fa0665b02c8f6f505c2255a2f1">NodeDataPtr</a> &amp;node_data) {
<a name="l00176"></a>00176       boost::mutex::scoped_lock <a class="code" href="class_hyperspace_1_1_master.html#e9ff9f9b68e57c5a9c1f8ab1b06bc9a1">lock</a>(<a class="code" href="class_hyperspace_1_1_master.html#f551e5b32ccd050cb2e94ba84a53af2c">m_node_map_mutex</a>);
<a name="l00177"></a>00177       NodeMap::iterator iter = <a class="code" href="class_hyperspace_1_1_master.html#c3e6abe4728305392b01e19263406ae9">m_node_map</a>.find(name);
<a name="l00178"></a>00178       <span class="keywordflow">if</span> (iter != <a class="code" href="class_hyperspace_1_1_master.html#c3e6abe4728305392b01e19263406ae9">m_node_map</a>.end()) {
<a name="l00179"></a>00179         node_data = (*iter).second;
<a name="l00180"></a>00180         <span class="keywordflow">return</span>;
<a name="l00181"></a>00181       }
<a name="l00182"></a>00182       node_data = <span class="keyword">new</span> <a class="code" href="class_hyperspace_1_1_node_data.html">NodeData</a>();
<a name="l00183"></a>00183       node_data-&gt;name = name;
<a name="l00184"></a>00184       <a class="code" href="class_hyperspace_1_1_master.html#c3e6abe4728305392b01e19263406ae9">m_node_map</a>[name] = node_data;
<a name="l00185"></a>00185     }
<a name="l00186"></a>00186 
<a name="l00187"></a><a class="code" href="class_hyperspace_1_1_master.html#684a86c95bd53a5ccf00f7d98dd5d991">00187</a>     <span class="keyword">typedef</span> hash_map&lt;std::string, NodeDataPtr&gt; <a class="code" href="class_hyperspace_1_1_master.html#684a86c95bd53a5ccf00f7d98dd5d991">NodeMap</a>;
<a name="l00188"></a><a class="code" href="class_hyperspace_1_1_master.html#8b1f11aeec6f5ee27928bc56136f44ed">00188</a>     <span class="keyword">typedef</span> hash_map&lt;uint64_t, HandleDataPtr&gt;  <a class="code" href="class_hyperspace_1_1_master.html#8b1f11aeec6f5ee27928bc56136f44ed">HandleMap</a>;
<a name="l00189"></a><a class="code" href="class_hyperspace_1_1_master.html#4e46988cfbee58b282358fc40ab9777b">00189</a>     <span class="keyword">typedef</span> hash_map&lt;uint64_t, SessionDataPtr&gt; <a class="code" href="class_hyperspace_1_1_master.html#4e46988cfbee58b282358fc40ab9777b">SessionMap</a>;
<a name="l00190"></a><a class="code" href="class_hyperspace_1_1_master.html#0217cde583eda5c4d9e376597f18123c">00190</a>     <span class="keyword">typedef</span> std::vector&lt;SessionDataPtr&gt; <a class="code" href="class_hyperspace_1_1_master.html#0217cde583eda5c4d9e376597f18123c">SessionDataVec</a>;
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="class_hyperspace_1_1_master.html#74924c1db7e0185ad3101079fe639193">00192</a>     <span class="keywordtype">bool</span>          <a class="code" href="class_hyperspace_1_1_master.html#74924c1db7e0185ad3101079fe639193">m_verbose</a>;
<a name="l00193"></a><a class="code" href="class_hyperspace_1_1_master.html#78f7694247f776086456eaaae1fefd5b">00193</a>     uint32_t      <a class="code" href="class_hyperspace_1_1_master.html#78f7694247f776086456eaaae1fefd5b">m_lease_interval</a>;
<a name="l00194"></a><a class="code" href="class_hyperspace_1_1_master.html#aa0d1cd2ea51b5ea02f4f2b2e48c7e23">00194</a>     uint32_t      <a class="code" href="class_hyperspace_1_1_master.html#aa0d1cd2ea51b5ea02f4f2b2e48c7e23">m_keep_alive_interval</a>;
<a name="l00195"></a><a class="code" href="class_hyperspace_1_1_master.html#c3e6abe4728305392b01e19263406ae9">00195</a>     <a class="code" href="class_hyperspace_1_1_master.html#684a86c95bd53a5ccf00f7d98dd5d991">NodeMap</a>       <a class="code" href="class_hyperspace_1_1_master.html#c3e6abe4728305392b01e19263406ae9">m_node_map</a>;
<a name="l00196"></a><a class="code" href="class_hyperspace_1_1_master.html#f4602500be052394c86434fabd34aee4">00196</a>     <a class="code" href="class_hyperspace_1_1_master.html#8b1f11aeec6f5ee27928bc56136f44ed">HandleMap</a>     <a class="code" href="class_hyperspace_1_1_master.html#f4602500be052394c86434fabd34aee4">m_handle_map</a>;
<a name="l00197"></a><a class="code" href="class_hyperspace_1_1_master.html#88e33a8e7788ddd2b6500058a7fd21cf">00197</a>     <a class="code" href="class_hyperspace_1_1_master.html#4e46988cfbee58b282358fc40ab9777b">SessionMap</a>    <a class="code" href="class_hyperspace_1_1_master.html#88e33a8e7788ddd2b6500058a7fd21cf">m_session_map</a>;
<a name="l00198"></a><a class="code" href="class_hyperspace_1_1_master.html#f551e5b32ccd050cb2e94ba84a53af2c">00198</a>     boost::mutex  <a class="code" href="class_hyperspace_1_1_master.html#f551e5b32ccd050cb2e94ba84a53af2c">m_node_map_mutex</a>;
<a name="l00199"></a><a class="code" href="class_hyperspace_1_1_master.html#08708caf5e61a7ca0fd5194607c9d591">00199</a>     boost::mutex  <a class="code" href="class_hyperspace_1_1_master.html#08708caf5e61a7ca0fd5194607c9d591">m_handle_map_mutex</a>;
<a name="l00200"></a><a class="code" href="class_hyperspace_1_1_master.html#d278d8aafc97c4d91ca85bb1387591b7">00200</a>     boost::mutex  <a class="code" href="class_hyperspace_1_1_master.html#d278d8aafc97c4d91ca85bb1387591b7">m_session_map_mutex</a>;
<a name="l00201"></a><a class="code" href="class_hyperspace_1_1_master.html#6467ad31ce40d1d6349f65bea65710dc">00201</a>     std::string   <a class="code" href="class_hyperspace_1_1_master.html#6467ad31ce40d1d6349f65bea65710dc">m_base_dir</a>;
<a name="l00202"></a><a class="code" href="class_hyperspace_1_1_master.html#fa4b03cf5f97b0311bf2ff5caa71e9ca">00202</a>     <span class="keywordtype">int</span>           <a class="code" href="class_hyperspace_1_1_master.html#fa4b03cf5f97b0311bf2ff5caa71e9ca">m_base_fd</a>;
<a name="l00203"></a><a class="code" href="class_hyperspace_1_1_master.html#61be2490ab22f16ad3f77b30cf2ab387">00203</a>     uint32_t      <a class="code" href="class_hyperspace_1_1_master.html#61be2490ab22f16ad3f77b30cf2ab387">m_generation</a>;
<a name="l00204"></a><a class="code" href="class_hyperspace_1_1_master.html#380fec971fede649713239226a71c73c">00204</a>     uint64_t      <a class="code" href="class_hyperspace_1_1_master.html#380fec971fede649713239226a71c73c">m_next_handle_number</a>;
<a name="l00205"></a><a class="code" href="class_hyperspace_1_1_master.html#31fbb7aaa2a6575f541414c17e94036a">00205</a>     uint64_t      <a class="code" href="class_hyperspace_1_1_master.html#31fbb7aaa2a6575f541414c17e94036a">m_next_session_id</a>;
<a name="l00206"></a><a class="code" href="class_hyperspace_1_1_master.html#fc45c1592d3ac18c2d2812900c2e29c6">00206</a>     <a class="code" href="namespace_hyperspace.html#3e886fe6754f12ba9f134097157d2673">ServerKeepaliveHandlerPtr</a> <a class="code" href="class_hyperspace_1_1_master.html#fc45c1592d3ac18c2d2812900c2e29c6">m_keepalive_handler_ptr</a>;
<a name="l00207"></a><a class="code" href="class_hyperspace_1_1_master.html#5d57a150539189795c452165d8dd3615">00207</a>     <span class="keyword">struct </span>sockaddr_in <a class="code" href="class_hyperspace_1_1_master.html#5d57a150539189795c452165d8dd3615">m_local_addr</a>;
<a name="l00208"></a><a class="code" href="class_hyperspace_1_1_master.html#ac5b803b7e72d03883aed01971611e34">00208</a>     <a class="code" href="class_hyperspace_1_1_master.html#0217cde583eda5c4d9e376597f18123c">SessionDataVec</a> <a class="code" href="class_hyperspace_1_1_master.html#ac5b803b7e72d03883aed01971611e34">m_session_heap</a>;
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     <span class="comment">// BerkeleyDB state</span>
<a name="l00211"></a><a class="code" href="class_hyperspace_1_1_master.html#f85cc02c2b361e3417a244d862a40d0b">00211</a>     <a class="code" href="class_hyperspace_1_1_berkeley_db_filesystem.html">BerkeleyDbFilesystem</a> *<a class="code" href="class_hyperspace_1_1_master.html#f85cc02c2b361e3417a244d862a40d0b">m_bdb_fs</a>;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213   };
<a name="l00214"></a>00214 
<a name="l00215"></a><a class="code" href="namespace_hyperspace.html#958cd34e946ce697f1382c5c145dd386">00215</a>   <span class="keyword">typedef</span> boost::intrusive_ptr&lt;Master&gt; <a class="code" href="namespace_hyperspace.html#958cd34e946ce697f1382c5c145dd386">MasterPtr</a>;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 } <span class="comment">// namespace Hyperspace</span>
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 <span class="preprocessor">#endif // HYPERSPACE_MASTER_H</span>
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Fri Aug 1 14:19:22 2008 for hypertable by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
